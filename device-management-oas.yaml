openapi: 3.0.0
info:
  title: 設備管理システム - 権限管理 API
  description: DA04部門内機器管理システムの権限管理モジュール OpenAPI 仕様
  version: 1.0.0
  contact:
    name: 設備管理APIサポート
    email: equip-support@example.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT

servers:
  - url: https://api.example.com/v1
    description: 本番サーバー
  - url: https://staging-api.example.com/v1
    description: ステージングサーバー

tags:
  - name: 権限管理
    description: 設備使用権限管理操作

paths:
  # 権限管理モジュール - 個別権限操作
  /permissions/{permissionId}:
    get:
      tags:
        - 権限管理
      summary: 権限詳細取得
      description: 権限IDに基づき権限詳細情報を取得
      operationId: getPermissionDetail
      parameters:
        - name: permissionId
          in: path
          required: true
          description: 権限ID (文字列)
          schema:
            type: string
            example: "PERM001"
      responses:
        "200":
          description: 権限詳細取得成功
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse_PermissionDetail"
        "404":
          description: 権限が存在しません
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    put:
      tags:
        - 権限管理
      summary: 権限情報更新
      description: 権限情報を更新（フィールド単位）
      operationId: updatePermissionByFields
      parameters:
        - name: permissionId
          in: path
          required: true
          schema:
            type: string
            example: "PERM001"
        - name: smartitStatusId
          in: query
          required: false
          description: SmartITステータスID
          schema:
            type: string
        - name: noSmartitReason
          in: query
          required: false
          description: SmartIT未インストール理由
          schema:
            type: string
        - name: usbStatusId
          in: query
          required: false
          description: USBステータスID
          schema:
            type: string
        - name: usbReason
          in: query
          required: false
          description: USB使用許可理由
          schema:
            type: string
        - name: usbExpireDate
          in: query
          required: false
          description: USB使用有効期限
          schema:
            type: string
            format: date
            example: "2025-12-31"
        - name: antivirusStatusId
          in: query
          required: false
          description: アンチウイルスステータスID
          schema:
            type: string
        - name: noSymantecReason
          in: query
          required: false
          description: Symantec未導入理由
          schema:
            type: string
        - name: domainStatusId
          in: query
          required: false
          description: ドメインステータスID
          schema:
            type: string
        - name: domainGroup
          in: query
          required: false
          description: ドメイン内グループ名
          schema:
            type: string
        - name: noDomainReason
          in: query
          required: false
          description: ドメイン未参加理由
          schema:
            type: string
        - name: remark
          in: query
          required: false
          description: 備考
          schema:
            type: string
      responses:
        "200":
          description: 権限更新成功
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiResponse_Void"
        "400":
          description: 無効なリクエストデータ
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: 権限が存在しません
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

components:
  schemas:
    # 共通レスポンススキーマ
    ApiResponse_PermissionDetail:
      type: object
      properties:
        code:
          type: string
          description: レスポンスコード
          example: "SUCCESS"
        message:
          type: string
          description: レスポンスメッセージ
          example: "検索に成功しました"
        data:
          $ref: "#/components/schemas/DeviceUsagePermissionDTO"

    ApiResponse_Void:
      type: object
      properties:
        code:
          type: string
          description: レスポンスコード
          example: "SUCCESS"
        message:
          type: string
          description: レスポンスメッセージ
          example: "更新に成功しました"
        data:
          type: object
          nullable: true
          description: 空データ

    Error:
      type: object
      properties:
        code:
          type: string
          description: エラーコード
          example: "NOT_FOUND"
        message:
          type: string
          description: エラーメッセージ
          example: "権限情報が存在しません"
        timestamp:
          type: string
          format: date-time
          description: エラー発生時刻

    # DTOスキーマ
    DeviceUsagePermissionDTO:
      type: object
      properties:
        permissionId:
          type: string
          description: 権限番号
        deviceId:
          type: string
          description: 機器番号
        computerName:
          type: string
          description: コンピュータ名
        deviceModel:
          type: string
          description: ホストモデル
        project:
          type: string
          description: 所属プロジェクト
        devRoom:
          type: string
          description: 所属開発室
        userId:
          type: string
          description: ユーザID
        userName:
          type: string
          description: ユーザ名
        deptId:
          type: string
          description: 部署ID
        domainStatus:
          type: string
          description: ドメイン状態
        domainGroup:
          type: string
          description: ドメイン内グループ名
        noDomainReason:
          type: string
          description: ドメイン未参加理由
        smartitStatus:
          type: string
          description: SmartIT状態
        noSmartitReason:
          type: string
          description: SmartIT未インストール理由
        usbStatus:
          type: string
          description: USB状態
        usbReason:
          type: string
          description: USB使用許可理由
        usbExpireDate:
          type: string
          format: date
          description: USB使用有効期限
        antivirusStatus:
          type: string
          description: アンチウイルス状態
        noSymantecReason:
          type: string
          description: Symantec未導入理由
        remark:
          type: string
          description: 備考
        createTime:
          type: string
          format: date-time
          description: 作成日時
        creater:
          type: string
          description: 作成者
        updateTime:
          type: string
          format: date-time
          description: 更新日時
        updater:
          type: string
          description: 更新者