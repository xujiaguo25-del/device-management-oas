openapi: 3.0.0
info:
  title: device-management-oas
  version: 1.0.0
servers:
  - url: http://localhost:8080/api

paths:
  /auth/login:
    post:
      tags:
        - 認証API
      summary: ユーザーログイン
      description: ユーザID（user_id）とパスワードでシステムにログインし、JWTトークンを取得
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
      responses:
        '200':
          description: ログイン成功、トークンとユーザー情報を返却
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoginResponse'
        '400':
          description: リクエストパラメータエラー
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                パラメータ不足:
                  value:
                    code: 400
                    message: "userIdとpasswordは必須です"
                    data: null
                    total: null
                    page: null
                    size: null
        '401':
          description: 認証エラー
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                ユーザーが存在しない:
                  value:
                    code: 401
                    message: "ユーザーが存在しません"
                    data: null
                    total: null
                    page: null
                    size: null
                パスワードが誤り:
                  value:
                    code: 401
                    message: "パスワードが正しくありません"
                    data: null
                    total: null
                    page: null
                    size: null
        '500':
          description: サーバー内部エラー
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /auth/logout:
    post:
      tags:
        - 認証API
      summary: ユーザーログアウト
      description: 現在のユーザーセッションを終了（クライアントはローカルトークンを削除する必要あり）
      security:
        - bearerAuth: []
      responses:
        '200':
          description: ログアウト成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LogoutResponse'
        '401':
          description: 認証エラー
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                トークンが無効:
                  value:
                    code: 401
                    message: "トークンが無効です"
                    data: null
                    total: null
                    page: null
                    size: null
                トークン期限切れ:
                  value:
                    code: 401
                    message: "トークンの有効期限が切れています"
                    data: null
                    total: null
                    page: null
                    size: null

  /auth/change-password:
    post:
      summary: パスワード変更
      description: ログイン済みのユーザーが userId を使用して自身のログインパスワードを変更します。有効な JWT が必要です。
      tags:
        - 認証API
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ChangePasswordRequest'
      responses:
        '200':
          description: パスワードの更新が成功しました
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChangePasswordResponse'
        '400':
          description: ビジネスロジックの検証に失敗しました
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                wrongCurrent:
                  value:
                    code: 40001
                    message: "現在のパスワードが正しくありません"
                    data: null
                    total: null
                    page: null
                    size: null
                weakNew:
                  value:
                    code: 40002
                    message: "新しいパスワードが強度要件を満たしていません"
                    data: null
                    total: null
                    page: null
                    size: null
                sameAsOld:
                  value:
                    code: 40003
                    message: "新しいパスワードは古いパスワードと同じにすることはできません"
                    data: null
                    total: null
                    page: null
                    size: null
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalError'

  /dict/items:
    get:
      summary: 辞書項目の取得
      description: 登録されている辞書項目を取得します（sortフィールドで昇順ソート済）。
      tags:
        - 共通API
      security:
        - bearerAuth: []

      responses:
        '200':
          description: 辞書項目の取得に成功しました
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DictSuccessResponse'
              examples:
                successExample:
                  $ref: '#/components/examples/DictSuccessExample'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          description: サーバー内部エラー
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                serverErrorExample:
                  $ref: '#/components/examples/DictServerErrorExample'

  /security-checks:
    get:
      summary: セキュリティチェック記録一覧の取得
      deprecated: false
      description: すべてのセキュリティチェック記録を取得し、デバイスIDおよびユーザーIDでの絞り込みとページング取得に対応します
      tags:
        - セキュリティチェック
      parameters:
      - name: page
        in: query
        description: ページ番号
        required: true
        example: 1
        schema:
          type: integer
          default: 1
      - name: size
        in: query
        description: 1ページ当たりの件数
        required: false
        example: 10
        schema:
          type: integer
          default: 10
      - name: deviceId
        in: query
        description: デバイスID
        required: false
        example: デバイス001
        schema:
          type: string
      - name: userId
        in: query
        description: ユーザーID
        required: false
        example: ユーザー001
        schema:
          type: string
      responses:
        '200':
          description: 一覧取得成功
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      type: array
                      items:
                        $ref: '#/components/schemas/SampleCheckDTO'
                  required:
                  - data
              example:
                code: 200
                message: 取得に成功しました
                data:
                - samplingId: record001
                  userId: EMP00123
                  deviceId: DEV2024001
                  name: 山田太郎
                  reportId: SEC20240115001
                  updateDate: '2024-01-15'
                  createTime: '2024-01-10 09:00:00'
                  updateTime: '2024-01-15 10:00:00'
                  installedSoftware: true
                  disposalMeasures: 許可されていないソフトウェアをアンインストールし、システムを再起動しました
                  screenSaverPwd: true
                  usbInterface: false
                  securityPatch: true
                  antivirusProtection: true
                  bootAuthentication: true
                - samplingId: record002
                  userId: EMP00456
                  deviceId: DEV2024002
                  name: 佐藤花子
                  reportId: SEC20240115002
                  updateDate: '2024-01-16'
                  createTime: '2024-01-11 09:00:00'
                  updateTime: '2024-01-16 11:00:00'
                  installedSoftware: false
                  disposalMeasures: なし
                  screenSaverPwd: true
                  usbInterface: true
                  securityPatch: true
                  antivirusProtection: true
                  bootAuthentication: true
                total: 120
                page: 1
                size: 10
      security: []
    post:
      summary: 新規作成
      deprecated: false
      description: セキュリティチェック項目を新規作成します
      tags:
        - セキュリティチェック
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SampleCheckDTO'
            example:
              samplingId: record001
              userId: EMP00123
              deviceId: DEV2024001
              name: 山田太郎
              reportId: SEC20240115001
              updateDate: '2024-01-15'
              createTime: '2024-01-10 09:00:00'
              updateTime: '2024-01-15 10:00:00'
              installedSoftware: true
              disposalMeasures: 許可されていないソフトウェアをアンインストールし、システムを再起動しました
              screenSaverPwd: true
              usbInterface: false
              securityPatch: true
              antivirusProtection: true
              bootAuthentication: true
        required: true
      responses:
        '200':
          description: 追加に成功しました
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/SampleCheckDTO'
                  required:
                  - data
              example:
                code: 200
                message: 追加に成功しました
                data:
                  samplingId: record001
                  userId: EMP00123
                  deviceId: DEV2024001
                  name: 山田太郎
                  reportId: SEC20240115001
                  updateDate: '2024-01-15'
                  createTime: '2024-01-10 09:00:00'
                  updateTime: '2024-01-15 10:00:00'
                  installedSoftware: true
                  disposalMeasures: 許可されていないソフトウェアをアンインストールし、システムを再起動しました
                  screenSaverPwd: true
                  usbInterface: false
                  securityPatch: true
                  antivirusProtection: true
                  bootAuthentication: true
      security: []
  /security-checks/export:
    get:
      summary: レポート出力
      deprecated: false
      description: ''
      tags:
        - セキュリティチェック
      parameters:
      - name: reportCode
        in: query
        description: レポート番号（レポート番号で絞り込み）
        required: true
        example: ISMSFM1601-1
        schema:
          type: string
      responses:
        '200':
          description: レポートファイルを返却します。ファイル名はサーバ側で動的に生成されます
          content:
            application/octet-stream:
              schema:
                type: string
                format: binary
  /security-checks/{samplingId}:
    get:
      summary: セキュリティチェック詳細情報の取得
      deprecated: false
      description: セキュリティチェック記録の詳細情報を取得します
      operationId: query-checks-by-id
      tags:
        - セキュリティチェック
      parameters:
      - name: samplingId
        in: path
        description: セキュリティチェック記録ID
        example: record001
        required: true
        schema:
          type: string
      responses:
        '200':
          description: 詳細取得成功
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/SampleCheckDTO'
                  required:
                  - data
              example:
                code: 200
                message: 取得に成功しました
                data:
                  samplingId: record001
                  userId: EMP00123
                  deviceId: DEV2024001
                  name: 山田太郎
                  reportId: SEC20240115001
                  updateDate: '2024-01-15'
                  createTime: '2024-01-10 09:00:00'
                  updateTime: '2024-01-15 10:00:00'
                  installedSoftware: true
                  disposalMeasures: 許可されていないソフトウェアをアンインストールし、システムを再起動しました
                  screenSaverPwd: true
                  usbInterface: false
                  securityPatch: true
                  antivirusProtection: true
                  bootAuthentication: true
        '404':
          description: 対象が存在しません
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
              example:
                code: 404
                message: 対応するセキュリティチェック記録が見つかりません
                data: {}
      security: []
    put:
      summary: 更新
      deprecated: false
      description: セキュリティチェック記録を更新します
      tags:
        - セキュリティチェック
      parameters:
      - name: samplingId
        in: path
        description: セキュリティチェック記録ID
        required: true
        example: record001
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SampleCheckDTO'
            example:
              samplingId: record001
              userId: EMP00123
              deviceId: DEV2024001
              name: 山田太郎
              reportId: SEC20240115001
              updateDate: '2024-02-01'
              createTime: '2024-01-10 09:00:00'
              updateTime: '2024-02-01 18:00:00'
              installedSoftware: false
              disposalMeasures: アンインストール済み、再起動済み
              screenSaverPwd: true
              usbInterface: true
              securityPatch: true
              antivirusProtection: true
              bootAuthentication: true
              creater: システム管理者
              updater: 山田太郎
        required: true
      responses:
        '200':
          description: 更新に成功しました
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/SampleCheckDTO'
                  required:
                  - data
              example:
                code: 200
                message: 更新に成功しました
                data:
                  samplingId: record001
                  userId: EMP00123
                  deviceId: DEV2024001
                  name: 山田太郎
                  reportId: SEC20240115001
                  updateDate: '2024-02-01'
                  createTime: '2024-01-10 09:00:00'
                  updateTime: '2024-02-01 18:00:00'
                  installedSoftware: false
                  disposalMeasures: アンインストール済み、再起動済み
                  screenSaverPwd: true
                  usbInterface: true
                  securityPatch: true
                  antivirusProtection: true
                  bootAuthentication: true
                  creater: システム管理者
                  updater: 山田太郎
      security: []
    delete:
      summary: 削除
      deprecated: false
      description: セキュリティチェック記録を1件削除します
      tags:
        - セキュリティチェック
      parameters:
      - name: samplingId
        in: path
        description: セキュリティチェック記録ID
        required: true
        example: record001
        schema:
          type: string
      responses:
        '200':
          description: 削除に成功しました
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      type: object
                  required:
                  - data
              example:
                code: 200
                message: 削除に成功しました
                data: {}
      security: []

# =======================Permission
  /permissions:
    get:
      tags:
        - 権限管理
      summary: ページングによるデバイス権限情報の検索
      description: 検索条件に基づいてデバイス権限情報をページングで取得
      parameters:
        - name: page
          in: query
          description: ページ番号（1から開始）
          required: false
          schema:
            type: integer
            default: 1
            minimum: 1
        - name: size
          in: query
          description: 1ページあたりの記録数
          required: false
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 20
        - name: deviceId
          in: query
          description: デバイスID
          required: false
          schema:
            type: string
        - name: userId
          in: query
          description: ユーザーID
          required: false
          schema:
            type: string
      responses:
        '200':
          description: 検索成功
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 200
                  message:
                    type: string
                    example: 検索成功
                  total:
                    type: integer
                    description: 総記録数
                    example: 150
                  page:
                    type: integer
                    description: 現在のページ番号
                    example: 1
                  size:
                    type: integer
                    description: 1ページあたりの記録数
                    example: 10
                  data:
                    type: array
                    description: デバイス権限情報リスト
                    items:
                      type: object
                      properties:
                        permissionId:
                          type: string
                          description: 権限ID
                          example: "1"
                        deviceId:
                          type: string
                          description: デバイスID
                        computerName:
                          type: string
                          description: コンピュータ名
                          example: "DESKTOP-1234"
                        ipAddress:
                          type: array
                          items:
                            type: string
                          description: IPアドレス
                        userId:
                          type: string
                          description: ユーザーID
                          example: "JS0020"
                        name:
                          type: string
                          description: ユーザー名
                        deptId:
                          type: string
                          description: 部署ID
                        loginUsername:
                          type: string
                          description: ログインユーザー名
                        domainStatus:
                          type: integer
                          format: int64
                          description: ドメイン状態
                          example: 1
                        domainGroup:
                          type: string
                          description: ドメイングループ
                        noDomainReason:
                          type: string
                          description: ドメイン未設定理由
                        smartitStatus:
                          type: integer
                          format: int64
                          description: SmartIT状態
                          example: 2
                        noSmartitReason:
                          type: string
                          description: SmartIT未設定理由
                        usbStatus:
                          type: integer
                          format: int64
                          description: USB状態
                          example: 1
                        usbReason:
                          type: string
                          description: USB権限理由
                          example: "项目需要"
                        usbExpireDate:
                          type: string
                          format: date
                          description: USB権限有効期限
                          example: "2024-12-31"
                        antivirusStatus:
                          type: integer
                          format: int64
                          description: ウイルス対策ソフト状態
                          example: 1
                        noSymantecReason:
                          type: string
                          description: Symantec未設定理由
                        remark:
                          type: string
                          description: 備考
                          example: "テストデバイス"
    post:
      tags:
        - 権限管理
      summary: 権限作成
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DevicePermissionDTO'

      responses:
        '200':
          description: 権限作成成功
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseBase'
                  - properties:
                      code:
                        type: integer
                        example: 200
                      message:
                        type: string
                        example: "権限作成成功"
                      data:
                           $ref: '#/components/schemas/DevicePermissionDTO'

  /permissions/{permissionId}:
    get:
      tags:
        - 権限管理
      summary: 権限詳細取得
      description: 権限IDに基づき権限詳細情報を取得
      operationId: getPermissionDetail
      parameters:
        - name: permissionId
          in: path
          required: true
          description: 権限ID (文字列)
          schema:
            type: string
            example: "PERM001"
      responses:
        "200":
          description: 権限詳細取得成功
          content:
            application/json:
              schema:
               allOf:
                  - $ref: "#/components/schemas/ApiResponseBase"
                  - properties:
                      code:
                        type: integer
                        example: 200
                      message:
                        type: string
                        example: "権限詳細取得成功"
                      data:
                        $ref: "#/components/schemas/DevicePermissionDetailDTO"
        "404":
          description: 権限が存在しません
          content:
            application/json:
              schema:
                allOf:
                 - $ref: "#/components/schemas/ApiResponseBase"
                 - properties:
                      code:
                        type: integer
                        example: 404
                      message:
                        type: string
                        example: "権限が存在しません"
    put:
      tags:
        - 権限管理
      summary: 権限情報更新
      description: 権限情報を更新（フィールド単位）
      operationId: updatePermissionByFields
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DevicePermissionUpdateDTO'
      # parameters:
      #   - name: permissionId
      #     in: path
      #     required: true
      #     schema:
      #       type: string
      #       example: "PERM001"
      #   - name: smartitStatusId
      #     in: query
      #     required: false
      #     description: SmartITステータスID
      #     schema:
      #       type: string
      #   - name: noSmartitReason
      #     in: query
      #     required: false
      #     description: SmartIT未インストール理由
      #     schema:
      #       type: string
      #   - name: usbStatusId
      #     in: query
      #     required: false
      #     description: USBステータスID
      #     schema:
      #       type: string
      #   - name: usbReason
      #     in: query
      #     required: false
      #     description: USB使用許可理由
      #     schema:
      #       type: string
      #   - name: usbExpireDate
      #     in: query
      #     required: false
      #     description: USB使用有効期限
      #     schema:
      #       type: string
      #       format: date
      #       example: "2025-12-31"
      #   - name: antivirusStatusId
      #     in: query
      #     required: false
      #     description: アンチウイルスステータスID
      #     schema:
      #       type: string
      #   - name: noSymantecReason
      #     in: query
      #     required: false
      #     description: Symantec未導入理由
      #     schema:
      #       type: string
      #   - name: domainStatusId
      #     in: query
      #     required: false
      #     description: ドメインステータスID
      #     schema:
      #       type: string
      #   - name: domainGroup
      #     in: query
      #     required: false
      #     description: ドメイン内グループ名
      #     schema:
      #       type: string
      #   - name: noDomainReason
      #     in: query
      #     required: false
      #     description: ドメイン未参加理由
      #     schema:
      #       type: string
      #   - name: remark
          # in: query
          # required: false
          # description: 備考
          # schema:
          #   type: string
      responses:
        "200":
          description: 権限更新成功
          content:
            application/json:
              schema:
                allOf:
                 - $ref: "#/components/schemas/ApiResponseBase"
                 - properties:
                      code:
                        type: integer
                        example: 200
                      message:
                        type: string
                        example: "権限更新成功"
        "400":
          description: 無効なリクエストデータ
          content:
            application/json:
              schema:
               allOf:
                - $ref: "#/components/schemas/ApiResponseBase"
                - properties:
                    code:
                      type: integer
                      example: 400
                    message:
                      type: string
                      example: "無効なリクエストデータ"

        "404":
          description: 権限が存在しません
          content:
            application/json:
             schema:
               allOf:
                - $ref: "#/components/schemas/ApiResponseBase"
                - properties:
                    code:
                      type: integer
                      example: 404
                    message:
                      type: string
                      example: "権限が存在しません"

    delete:
        summary: デバイス使用権限の削除
        description: 権限と関連関係の検証後、指定された権限を削除します
        tags:
        - 権限管理
        parameters:
          - name: permissionId
            in: path
            required: true
            schema:
              type: integer
              format: int64
              example: 1001
        responses:
          '200':
            description: 削除成功
            content:
              application/json:
               schema:
                 allOf:
                  - $ref: "#/components/schemas/ApiResponseBase"
                  - properties:
                      code:
                        type: integer
                        example: 200
                      message:
                        type: string
                        example: "削除成功"
          '403':
            description: 削除権限なし
            content:
              application/json:
                schema:
                 allOf:
                  - $ref: "#/components/schemas/ApiResponseBase"
                  - properties:
                      code:
                        type: integer
                        example: 403
                      message:
                        type: string
                        example: "削除権限なし"
          '404':
            description: 権限が存在しない
            content:
              application/json:
                schema:
                 allOf:
                  - $ref: "#/components/schemas/ApiResponseBase"
                  - properties:
                      code:
                        type: integer
                        example: 404
                      message:
                        type: string
                        example: "権限が存在しない"
          '400':
            description: 権限がリソースに関連づけられている
            content:
              application/json:
                schema:
                 allOf:
                  - $ref: "#/components/schemas/ApiResponseBase"
                  - properties:
                      code:
                        type: integer
                        example: 400
                      message:
                        type: string
                        example: "権限がリソースに関連づけられている"

  /permissions/export:
    get:
      tags:
        - 権限管理
      summary: 権限一覧エクスポート
      # parameters:
      #   - name: page
      #     in: query
      #     description: ページ番号
      #     required: false
      #     schema:
      #       type: integer
      #   - name: size
      #     in: query
      #     description: 1ページあたりの件数
      #     required: false
      #     schema:
      #       type: integer
      responses:
        '200':
          description: Excelファイル
          content:
            application/vnd.openxmlformats-officedocument.spreadsheetml.sheet:
              schema:
                type: string
                format: binary
# =======================Permission

  /devices:
    get:
      tags:
        - devices
      summary: 設備リスト照会
      description: ページング・フィルタリングに対応した設備リスト照会インターフェース
      parameters:
        - name: page
          in: query
          description: ページ番号（1から開始）
          required: false
          schema:
            type: integer
            minimum: 1
            example: 1
        - name: size
          in: query
          description: 1ページあたりの件数
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            example: 10
        - name: userId
          in: query
          description: ユーザーID（フィルタ条件）
          required: false
          schema:
            type: string
            example: JS0014
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DevicePageResponse'
      responses:
        '200':
          $ref: '#/components/responses/SuccessWithPagination'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
    
    post:
      tags:
        - devices
      summary: 設備を新規追加
      description: 新しい設備情報を追加します
      operationId: insertDevice
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/InsertDeviceFullDTO'

      responses:
        '200':
          $ref: '#/components/responses/InsertSuccess'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'


  /devices/{id}:
    parameters:
      - name: id
        in: path
        description: 設備ID
        required: true
        schema:
          type: string
          example: HYRON-221129 PC-DC-089
      - name: userId
        in: query
        description: ユーザーID（フィルタ条件）
        required: false
        schema:
          type: string
          example: JS0014

    get:
      tags:
        - devices
      summary: 設備詳細照会
      description: 設備IDに基づき設備詳細情報を照会
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Device'
      responses:
        '200':
          $ref: '#/components/responses/SuccessWithDetail'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'


    put:
      tags:
        - devices
      summary: 設備情報を編集
      description: 設備情報を修正します
      operationId: updateDevice
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateDeviceFullDTO'

      responses:
        '200':
          $ref: '#/components/responses/UpdateSuccess'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
    
    delete:
      tags:
        - devices
      summary: 設備を削除
      description: 設備IDに基づいて指定された設備の記録を削除する
      operationId: deleteDevice

      responses:
        '200':
          $ref: '#/components/responses/Success'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          description: 設備が存在しません
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
              examples:
                deviceNotFound:
                  value:
                    code: 404
                    message: "設備が存在しません"
                    data: null
                    total: null
                    page: null
                    size: null

        '500':
          $ref: '#/components/responses/InternalServerError'

  /devices/export:
    get:
      tags:
        - devices
      summary: 設備情報をエクスポート
      description: すべての設備情報をExcelファイルにエクスポートする
      operationId: exportDevices
      responses:
        '200':
          description: 設備リストのエクスポートに成功しました
          content:
            application/vnd.openxmlformats-officedocument.spreadsheetml.sheet:
              schema:
                type: string
                format: binary
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /security-checks:
    get:
      summary: セキュリティチェック記録一覧の取得
      deprecated: false
      description: すべてのセキュリティチェック記録を取得し、デバイスIDおよびユーザーIDでの絞り込みとページング取得に対応します
      tags:
        - セキュリティチェック
      parameters:
      - name: page
        in: query
        description: ページ番号
        required: true
        example: 1
        schema:
          type: integer
          default: 1
      - name: size
        in: query
        description: 1ページ当たりの件数
        required: false
        example: 10
        schema:
          type: integer
          default: 10
      - name: deviceId
        in: query
        description: デバイスID
        required: false
        example: デバイス001
        schema:
          type: string
      - name: userId
        in: query
        description: ユーザーID
        required: false
        example: ユーザー001
        schema:
          type: string
      responses:
        '200':
          description: 一覧取得成功
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      type: array
                      items:
                        $ref: '#/components/schemas/SampleCheckDTO'
                  required:
                  - data
              example:
                code: 200
                message: 取得に成功しました
                data:
                - samplingId: record001
                  userId: EMP00123
                  deviceId: DEV2024001
                  name: 山田太郎
                  reportId: SEC20240115001
                  updateDate: '2024-01-15'
                  createTime: '2024-01-10 09:00:00'
                  updateTime: '2024-01-15 10:00:00'
                  installedSoftware: true
                  disposalMeasures: 許可されていないソフトウェアをアンインストールし、システムを再起動しました
                  screenSaverPwd: true
                  usbInterface: false
                  securityPatch: true
                  antivirusProtection: true
                  bootAuthentication: true
                - samplingId: record002
                  userId: EMP00456
                  deviceId: DEV2024002
                  name: 佐藤花子
                  reportId: SEC20240115002
                  updateDate: '2024-01-16'
                  createTime: '2024-01-11 09:00:00'
                  updateTime: '2024-01-16 11:00:00'
                  installedSoftware: false
                  disposalMeasures: なし
                  screenSaverPwd: true
                  usbInterface: true
                  securityPatch: true
                  antivirusProtection: true
                  bootAuthentication: true
                total: 120
                page: 1
                size: 10
      security: []
    post:
      summary: 新規作成
      deprecated: false
      description: セキュリティチェック項目を新規作成します
      tags:
        - セキュリティチェック
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SampleCheckDTO'
            example:
              samplingId: record001
              userId: EMP00123
              deviceId: DEV2024001
              name: 山田太郎
              reportId: SEC20240115001
              updateDate: '2024-01-15'
              createTime: '2024-01-10 09:00:00'
              updateTime: '2024-01-15 10:00:00'
              installedSoftware: true
              disposalMeasures: 許可されていないソフトウェアをアンインストールし、システムを再起動しました
              screenSaverPwd: true
              usbInterface: false
              securityPatch: true
              antivirusProtection: true
              bootAuthentication: true
        required: true
      responses:
        '200':
          description: 追加に成功しました
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/SampleCheckDTO'
                  required:
                  - data
              example:
                code: 200
                message: 追加に成功しました
                data:
                  samplingId: record001
                  userId: EMP00123
                  deviceId: DEV2024001
                  name: 山田太郎
                  reportId: SEC20240115001
                  updateDate: '2024-01-15'
                  createTime: '2024-01-10 09:00:00'
                  updateTime: '2024-01-15 10:00:00'
                  installedSoftware: true
                  disposalMeasures: 許可されていないソフトウェアをアンインストールし、システムを再起動しました
                  screenSaverPwd: true
                  usbInterface: false
                  securityPatch: true
                  antivirusProtection: true
                  bootAuthentication: true
      security: []
  /security-checks/export:
    get:
      summary: レポート出力
      deprecated: false
      description: ''
      tags:
        - セキュリティチェック
      parameters:
      - name: reportCode
        in: query
        description: レポート番号（レポート番号で絞り込み）
        required: true
        example: ISMSFM1601-1
        schema:
          type: string
      responses:
        '200':
          description: レポートファイルを返却します。ファイル名はサーバ側で動的に生成されます
          content:
            application/octet-stream:
              schema:
                type: string
                format: binary
  /security-checks/{samplingId}:
    get:
      summary: セキュリティチェック詳細情報の取得
      deprecated: false
      description: セキュリティチェック記録の詳細情報を取得します
      operationId: query-checks-by-id
      tags:
        - セキュリティチェック
      parameters:
      - name: samplingId
        in: path
        description: セキュリティチェック記録ID
        example: record001
        required: true
        schema:
          type: string
      responses:
        '200':
          description: 詳細取得成功
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/SampleCheckDTO'
                  required:
                  - data
              example:
                code: 200
                message: 取得に成功しました
                data:
                  samplingId: record001
                  userId: EMP00123
                  deviceId: DEV2024001
                  name: 山田太郎
                  reportId: SEC20240115001
                  updateDate: '2024-01-15'
                  createTime: '2024-01-10 09:00:00'
                  updateTime: '2024-01-15 10:00:00'
                  installedSoftware: true
                  disposalMeasures: 許可されていないソフトウェアをアンインストールし、システムを再起動しました
                  screenSaverPwd: true
                  usbInterface: false
                  securityPatch: true
                  antivirusProtection: true
                  bootAuthentication: true
        '404':
          description: 対象が存在しません
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
              example:
                code: 404
                message: 対応するセキュリティチェック記録が見つかりません
                data: {}
      security: []
    put:
      summary: 更新
      deprecated: false
      description: セキュリティチェック記録を更新します
      tags:
        - セキュリティチェック
      parameters:
      - name: samplingId
        in: path
        description: セキュリティチェック記録ID
        required: true
        example: record001
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SampleCheckDTO'
            example:
              samplingId: record001
              userId: EMP00123
              deviceId: DEV2024001
              name: 山田太郎
              reportId: SEC20240115001
              updateDate: '2024-02-01'
              createTime: '2024-01-10 09:00:00'
              updateTime: '2024-02-01 18:00:00'
              installedSoftware: false
              disposalMeasures: アンインストール済み、再起動済み
              screenSaverPwd: true
              usbInterface: true
              securityPatch: true
              antivirusProtection: true
              bootAuthentication: true
              creater: システム管理者
              updater: 山田太郎
        required: true
      responses:
        '200':
          description: 更新に成功しました
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/SampleCheckDTO'
                  required:
                  - data
              example:
                code: 200
                message: 更新に成功しました
                data:
                  samplingId: record001
                  userId: EMP00123
                  deviceId: DEV2024001
                  name: 山田太郎
                  reportId: SEC20240115001
                  updateDate: '2024-02-01'
                  createTime: '2024-01-10 09:00:00'
                  updateTime: '2024-02-01 18:00:00'
                  installedSoftware: false
                  disposalMeasures: アンインストール済み、再起動済み
                  screenSaverPwd: true
                  usbInterface: true
                  securityPatch: true
                  antivirusProtection: true
                  bootAuthentication: true
                  creater: システム管理者
                  updater: 山田太郎
      security: []
    delete:
      summary: 削除
      deprecated: false
      description: セキュリティチェック記録を1件削除します
      tags:
        - セキュリティチェック
      parameters:
      - name: samplingId
        in: path
        description: セキュリティチェック記録ID
        required: true
        example: record001
        schema:
          type: string
      responses:
        '200':
          description: 削除に成功しました
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      type: object
                  required:
                  - data
              example:
                code: 200
                message: 削除に成功しました
                data: {}
      security: []

# =======================Permission
  /permissions:
    get:
      tags:
        - 権限管理
      summary: ページングによるデバイス権限情報の検索
      description: 検索条件に基づいてデバイス権限情報をページングで取得
      parameters:
        - name: page
          in: query
          description: ページ番号（1から開始）
          required: false
          schema:
            type: integer
            default: 1
            minimum: 1
        - name: size
          in: query
          description: 1ページあたりの記録数
          required: false
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 20
        - name: deviceId
          in: query
          description: デバイスID
          required: false
          schema:
            type: string
        - name: userId
          in: query
          description: ユーザーID
          required: false
          schema:
            type: string
      responses:
        '200':
          description: 検索成功
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 200
                  message:
                    type: string
                    example: 検索成功
                  total:
                    type: integer
                    description: 総記録数
                    example: 150
                  page:
                    type: integer
                    description: 現在のページ番号
                    example: 1
                  size:
                    type: integer
                    description: 1ページあたりの記録数
                    example: 10
                  data:
                    type: array
                    description: デバイス権限情報リスト
                    items:
                      type: object
                      properties:
                        permissionId:
                          type: string
                          description: 権限ID
                          example: "1"
                        deviceId:
                          type: string
                          description: デバイスID
                        computerName:
                          type: string
                          description: コンピュータ名
                          example: "DESKTOP-1234"
                        ipAddress:
                          type: array
                          items:
                            type: string
                          description: IPアドレス
                        userId:
                          type: string
                          description: ユーザーID
                          example: "JS0020"
                        name:
                          type: string
                          description: ユーザー名
                        deptId:
                          type: string
                          description: 部署ID
                        loginUsername:
                          type: string
                          description: ログインユーザー名
                        domainStatus:
                          type: integer
                          format: int64
                          description: ドメイン状態
                          example: 1
                        domainGroup:
                          type: string
                          description: ドメイングループ
                        noDomainReason:
                          type: string
                          description: ドメイン未設定理由
                        smartitStatus:
                          type: integer
                          format: int64
                          description: SmartIT状態
                          example: 2
                        noSmartitReason:
                          type: string
                          description: SmartIT未設定理由
                        usbStatus:
                          type: integer
                          format: int64
                          description: USB状態
                          example: 1
                        usbReason:
                          type: string
                          description: USB権限理由
                          example: "项目需要"
                        usbExpireDate:
                          type: string
                          format: date
                          description: USB権限有効期限
                          example: "2024-12-31"
                        antivirusStatus:
                          type: integer
                          format: int64
                          description: ウイルス対策ソフト状態
                          example: 1
                        noSymantecReason:
                          type: string
                          description: Symantec未設定理由
                        remark:
                          type: string
                          description: 備考
                          example: "テストデバイス"
    post:
      tags:
        - 権限管理
      summary: 権限作成
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DevicePermissionDTO'

      responses:  
        '200':
          description: 権限作成成功
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseBase'
                  - properties:
                      code: 
                        type: integer
                        example: 200
                      message: 
                        type: string
                        example: "権限作成成功"    
                      data:
                           $ref: '#/components/schemas/DevicePermissionDTO'
                                    
  /permissions/{permissionId}:
    get:
      tags:
        - 権限管理
      summary: 権限詳細取得
      description: 権限IDに基づき権限詳細情報を取得
      operationId: getPermissionDetail
      parameters:
        - name: permissionId
          in: path
          required: true
          description: 権限ID (文字列)
          schema:
            type: string
            example: "PERM001"
      responses:
        "200":
          description: 権限詳細取得成功
          content:
            application/json:
              schema:
               allOf:
                  - $ref: "#/components/schemas/ApiResponseBase"
                  - properties:
                      code: 
                        type: integer
                        example: 200
                      message: 
                        type: string
                        example: "権限詳細取得成功"
                      data: 
                        $ref: "#/components/schemas/DevicePermissionDetailDTO"
        "404":
          description: 権限が存在しません
          content:
            application/json:
              schema:
                allOf:
                 - $ref: "#/components/schemas/ApiResponseBase"
                 - properties:
                      code: 
                        type: integer
                        example: 404
                      message: 
                        type: string
                        example: "権限が存在しません"
    put:
      tags:
        - 権限管理
      summary: 権限情報更新
      description: 権限情報を更新（フィールド単位）
      operationId: updatePermissionByFields
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DevicePermissionUpdateDTO'
      # parameters:
      #   - name: permissionId
      #     in: path
      #     required: true
      #     schema:
      #       type: string
      #       example: "PERM001"
      #   - name: smartitStatusId
      #     in: query
      #     required: false
      #     description: SmartITステータスID
      #     schema:
      #       type: string
      #   - name: noSmartitReason
      #     in: query
      #     required: false
      #     description: SmartIT未インストール理由
      #     schema:
      #       type: string
      #   - name: usbStatusId
      #     in: query
      #     required: false
      #     description: USBステータスID
      #     schema:
      #       type: string
      #   - name: usbReason
      #     in: query
      #     required: false
      #     description: USB使用許可理由
      #     schema:
      #       type: string
      #   - name: usbExpireDate
      #     in: query
      #     required: false
      #     description: USB使用有効期限
      #     schema:
      #       type: string
      #       format: date
      #       example: "2025-12-31"
      #   - name: antivirusStatusId
      #     in: query
      #     required: false
      #     description: アンチウイルスステータスID
      #     schema:
      #       type: string
      #   - name: noSymantecReason
      #     in: query
      #     required: false
      #     description: Symantec未導入理由
      #     schema:
      #       type: string
      #   - name: domainStatusId
      #     in: query
      #     required: false
      #     description: ドメインステータスID
      #     schema:
      #       type: string
      #   - name: domainGroup
      #     in: query
      #     required: false
      #     description: ドメイン内グループ名
      #     schema:
      #       type: string
      #   - name: noDomainReason
      #     in: query
      #     required: false
      #     description: ドメイン未参加理由
      #     schema:
      #       type: string
      #   - name: remark
          # in: query
          # required: false
          # description: 備考
          # schema:
          #   type: string
      responses:
        "200":
          description: 権限更新成功
          content:
            application/json:
              schema:
                allOf:
                 - $ref: "#/components/schemas/ApiResponseBase"
                 - properties:
                      code: 
                        type: integer
                        example: 200
                      message: 
                        type: string
                        example: "権限更新成功"
        "400":
          description: 無効なリクエストデータ
          content:
            application/json:
              schema:
               allOf:
                - $ref: "#/components/schemas/ApiResponseBase"
                - properties:
                    code: 
                      type: integer
                      example: 400
                    message: 
                      type: string
                      example: "無効なリクエストデータ"

        "404":
          description: 権限が存在しません
          content:
            application/json:
             schema:
               allOf:
                - $ref: "#/components/schemas/ApiResponseBase"
                - properties:
                    code: 
                      type: integer
                      example: 404
                    message: 
                      type: string
                      example: "権限が存在しません"

    delete:
        summary: デバイス使用権限の削除
        description: 権限と関連関係の検証後、指定された権限を削除します
        tags: 
        - 権限管理
        parameters:
          - name: permissionId
            in: path
            required: true
            schema:
              type: integer
              format: int64
              example: 1001
        responses:
          '200':
            description: 削除成功
            content:
              application/json:
               schema:
                 allOf:
                  - $ref: "#/components/schemas/ApiResponseBase"
                  - properties:
                      code: 
                        type: integer
                        example: 200
                      message: 
                        type: string
                        example: "削除成功"
          '403':
            description: 削除権限なし
            content:
              application/json:
                schema:
                 allOf:
                  - $ref: "#/components/schemas/ApiResponseBase"
                  - properties:
                      code: 
                        type: integer
                        example: 403
                      message: 
                        type: string
                        example: "削除権限なし"
          '404':
            description: 権限が存在しない
            content:
              application/json:
                schema:
                 allOf:
                  - $ref: "#/components/schemas/ApiResponseBase"
                  - properties:
                      code: 
                        type: integer
                        example: 404
                      message: 
                        type: string
                        example: "権限が存在しない"
          '400':
            description: 権限がリソースに関連づけられている
            content:
              application/json:
                schema:
                 allOf:
                  - $ref: "#/components/schemas/ApiResponseBase"
                  - properties:
                      code: 
                        type: integer
                        example: 400
                      message: 
                        type: string
                        example: "権限がリソースに関連づけられている" 

  /permissions/export:
    get:
      tags:
        - 権限管理
      summary: 権限一覧エクスポート
      # parameters:
      #   - name: page
      #     in: query
      #     description: ページ番号
      #     required: false
      #     schema:
      #       type: integer
      #   - name: size
      #     in: query
      #     description: 1ページあたりの件数
      #     required: false
      #     schema:
      #       type: integer
      responses:
        '200':
          description: Excelファイル
          content:
            application/vnd.openxmlformats-officedocument.spreadsheetml.sheet:
              schema:
                type: string
                format: binary
# =======================Permission

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  examples:
    DictSuccessExample:
      summary: 取得成功例
      value:
        code: 200
        message: "成功"
        data:
          - typeCode: "USB_STATUS"
            items:
              - dictId: 1
                dictItemName: "使用可"
                sort: 1
              - dictId: 2
                dictItemName: "使用不可"
                sort: 2
          - typeCode: "USER_TYPE"
            items:
              - dictId: 1
                dictItemName: "管理者"
                sort: 1
              - dictId: 2
                dictItemName: "一般ユーザー"
                sort: 2
        total: null
        page: null
        size: null

    DictServerErrorExample:
      summary: サーバー内部エラー例
      value:
        code: 50000
        message: "システムエラーが発生しました"
        data: null
        total: null
        page: null
        size: null

  schemas:
    SampleCheckDTO:
      title: SampleCheckDTO
      type: object
      required:
      - samplingId
      - userId
      - deviceId
      - name
      - reportId
      - updateDate
      properties:
        samplingId:
          type: string
          maxLength: 50
        userId:
          type: string
          maxLength: 50
        deviceId:
          type: string
          maxLength: 50
        installedSoftware:
          type: boolean
          nullable: true
        disposalMeasures:
          type: string
          maxLength: 65535
          nullable: true
        name:
          type: string
          maxLength: 100
        reportId:
          type: string
          maxLength: 50
        updateDate:
          type: string
          format: date
        screenSaverPwd:
          type: boolean
          nullable: true
        usbInterface:
          type: boolean
          nullable: true
        securityPatch:
          type: boolean
          nullable: true
        antivirusProtection:
          type: boolean
          nullable: true
        bootAuthentication:
          type: boolean
          nullable: true
        createTime:
          type: string
          description: 未指定时由システムで現在時刻が設定されます
        creater:
          type: string
          maxLength: 100
          nullable: true
        updateTime:
          type: string
          description: 未指定時由システムで現在時刻が設定されます
        updater:
          type: string
          maxLength: 100
          nullable: true
    ApiResponse:
      type: object
      properties:
        code:
          type: integer
          description: ステータスコード
        message:
          type: string
          description: 応答メッセージ
        data:
          description: レスポンスデータ（型はエンドポイントにより異なる）
        total:
          type: integer
          nullable: true
          description: 総件数（ページング時以外はnull）
        page:
          type: integer
          nullable: true
          description: 現在のページ（ページング時以外はnull）
        size:
          type: integer
          nullable: true
          description: 1ページあたりの件数（ページング時以外はnull）
      required:
        - code
        - message

    LoginRequest:
      type: object
      required:
        - userId
        - password
      properties:
        userId:
          type: string
          description: ユーザID（`users`テーブルの`user_id`フィールドに対応）
          example: "ADMIN001"
        password:
          type: string
          description: ユーザーパスワード
          example: "T+vWQMZO0qaTX+mfzbgrYA=="

    ChangePasswordRequest:
      type: object
      required:
        - userId
        - currentPassword
        - newPassword
      properties:
        userId:
          type: string
          description: ユーザー主キー（user_id）
          example: admin001
        currentPassword:
          type: string
          format: password
          description: 現在のパスワード
          example: "T+vWQMZO0qaTX+mfzbgrYA=="
        newPassword:
          type: string
          format: password
          minLength: 8
          pattern: '^(?=.*[A-Za-z])(?=.*\d)(?=.*[@$!%*?])[A-Za-z\d@$!%*?]{8,}$'
          description: 新しいパスワードは、文字、数字、特殊文字を含む必要があります
          example: "Y7bZjOtwGJorGjrKfLV2yQ=="

    # エラーレスポンス（dataはnull）
    ErrorResponse:
      allOf:
        - $ref: '#/components/schemas/ApiResponse'
        - type: object
          properties:
            data:
              type: object
              nullable: true
      example:
        code: 400
        message: "エラーメッセージ"
        data: null
        total: null
        page: null
        size: null
    # ログイン成功データ
    LoginData:
      type: object
      properties:
        token:
          type: string
          description: JWTアクセストークン
          example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
        userInfo:
          type: object
          properties:
            userId:
              type: string
              description: ユーザID
              example: "ADMIN001"
            name:
              type: string
              description: ユーザー氏名（`users`テーブルの`name`フィールドに対応）
              example: "システム管理者"
            userType:
              type: string
              description: ユーザータイプ（`dict`テーブルの`USER_TYPE`辞書項目に関連）
              example: "管理者"
            deptId:
              type: string
              description: 部門番号（`users`テーブルの`dept_id`フィールドに対応）
              example: "dept_001"

    # ログインレスポンス（ApiResponseを継承）
    LoginResponse:
      allOf:
        - $ref: '#/components/schemas/ApiResponse'
        - type: object
          properties:
            data:
              $ref: '#/components/schemas/LoginData'
          example:
            code: 200
            message: "ログイン成功"
            data:
              token: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
              userInfo:
                userId: "ADMIN001"
                name: "システム管理者"
                userType: "管理者"
                deptId: "dept_001"
            total: null
            page: null
            size: null

    # ログアウトレスポンス
    LogoutResponse:
      allOf:
        - $ref: '#/components/schemas/ApiResponse'
        - type: object
          properties:
            data:
              type: object
              nullable: true
              example: null
          example:
            code: 200
            message: "ログアウト成功"
            data: null
            total: null
            page: null
            size: null

    # パスワード変更レスポンス
    ChangePasswordResponse:
      allOf:
        - $ref: '#/components/schemas/ApiResponse'
        - type: object
          properties:
            data:
              type: object
              nullable: true
              example: null
          example:
            code: 200
            message: "パスワードが更新されました。再度ログインしてください。"
            data: null
            total: null
            page: null
            size: null
 


    # 辞書アイテム
    DictItem:
      type: object
      description: 統合辞書テーブルのデータ（ドロップダウン用：dictId=value、dictItemName=label）
      properties:
        dictId:
          type: integer
          format: int64
          description: 辞書ID（ドロップダウンvalue値）
          example: 1
        dictItemName:
          type: string
          description: 辞書項目名（ドロップダウンlabel値）
          example: "使用可"
        sort:
          type: integer
          description: ソート番号（昇順でソート済）
          example: 1

    # 辞書タイプグループ構造（typeCode + 対応するアイテムリスト）
    DictTypeGroup:
      type: object
      description: 辞書タイプグループ、タイプコードと該当タイプの全ての辞書アイテムを含む
      properties:
        typeCode:
          type: string
          description: 辞書タイプコード
          example: "USB_STATUS"
        items:
          type: array
          description: 該当辞書タイプの全てのアイテムリスト
          items:
            $ref: '#/components/schemas/DictItem'
          example:
            - dictId: 1
              dictItemName: "使用可"
              sort: 1
            - dictId: 2
              dictItemName: "使用不可"
              sort: 2

    # 辞書レスポンス（dataが配列型）
    DictSuccessResponse:
      allOf:
        - $ref: '#/components/schemas/ApiResponse'
        - type: object
          properties:
            data:
              type: array
              items:
                $ref: '#/components/schemas/DictTypeGroup'
          example:
            code: 200
            message: "成功"
            data:
              - typeCode: "USB_STATUS"
                items:
                  - dictId: 1
                    dictItemName: "使用可"
                    sort: 1
                  - dictId: 2
                    dictItemName: "使用不可"
                    sort: 2
              - typeCode: "USER_TYPE"
                items:
                  - dictId: 1
                    dictItemName: "管理者"
                    sort: 1
                  - dictId: 2
                    dictItemName: "一般ユーザー"
                    sort: 2
            total: null
            page: null
            size: null



    # ユーザー情報
    UserInfo:
      type: object
      description: ユーザー情報
      properties:
        userId:
          type: string
          description: ユーザーID
          example: JS0105
        deptId:
          type: string
          description: 部署ID
          example: DA04
        userName:
          type: string
          description: ユーザー名
          example: 潘小琴
        userType:
          $ref: '#/components/schemas/DictItem'
      required:
        - userId
        - userName
    
    # 設備オブジェクト
    Device:
      type: object
      description: 機器オブジェクト
      properties:
        deviceId:
          type: string
          description: 機器番号（プライマリキー）
          example: HYRON-221129 PC-DC-089
        deviceModel:
          type: string
          description: ホストモデル
          example: dell-5000
        computerName:
          type: string
          description: コンピュータ名
          example: DA04-LINF-PC
        loginUsername:
          type: string
          description: ログインユーザ名
          example: panxq-mac
        project:
          type: string
          description: 所属プロジェクト
          example: DA05支援
        devRoom:
          type: string
          description: 所属開発室
          example: M10
        userId:
          type: string
          description: 従業員番号（所属ユーザ、外部キー）
          example: JS0014
        remark:
          type: string
          description: 備考
          example: D1005開発室
        userInfo:
          $ref: '#/components/schemas/UserInfo'
        selfConfirm:
          $ref: '#/components/schemas/DictItem'
        os:
          $ref: '#/components/schemas/DictItem'
        memory:
          $ref: '#/components/schemas/DictItem'
        ssd:
          $ref: '#/components/schemas/DictItem'
        hdd:
          $ref: '#/components/schemas/DictItem'
        monitors:
          type: array
          description: モニター情報リスト
          items:
            $ref: '#/components/schemas/MonitorInfo'
        deviceIps:
          type: array
          description: IP情報リスト
          items:
            $ref: '#/components/schemas/DeviceIp'
        createTime:
          type: string
          format: date-time
          description: 作成日時
          example: "2026-01-06T06:55:28Z"
        creater:
          type: string
          description: 作成者
          example: admin
        updateTime:
          type: string
          format: date-time
          description: 更新日時
          example: "2026-01-06T06:55:28Z"
        updater:
          type: string
          description: 更新者
          example: admin
      required:
        - deviceId
        - userId
        - selfConfirm
        - os
        - memory


    
    # 設備IP情報エンティティ
    DeviceIp:
      type: object
      description: 設備のIP情報
      properties:
        ipAddress:
          type: string
          format: ipv4  # 或 ipv6
          pattern: '^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$'
          description: IPv4アドレス
          example: "192.168.1.1"

        createTime:
          type: string
          format: date-time
          description: 作成日時
          example: "2026-01-06T06:55:28Z"
        creater:
          type: string
          description: 作成者
          example: admin
        updateTime:
          type: string
          format: date-time
          description: 更新日時
          example: "2026-01-06T06:55:28Z"
        updater:
          type: string
          description: 更新者
          example: admin
      required:
        - deviceId
        - ipAddress
    
    # 設備モニター情報エンティティ
    MonitorInfo:
      type: object
      description: モニター情報
      properties:
        monitorName:
          type: string
          description: モニター名
          example: HYRON-241118 Minitor-131
        createTime:
          type: string
          format: date-time
          description: 作成日時
          example: "2026-01-06T06:55:28Z"
        creater:
          type: string
          description: 作成者
          example: admin
        updateTime:
          type: string
          format: date-time
          description: 更新日時
          example: "2026-01-06T06:55:28Z"
        updater:
          type: string
          description: 更新者
          example: admin
      required:
        - deviceId
        - monitorName
    
    # ページネーションレスポンス
    DevicePageResponse:
      type: object
      properties:
        content:
          type: array
          items:
            $ref: '#/components/schemas/Device'
        pageable:
          type: object
          properties:
            pageNumber:
              type: integer
              description: ページ番号
              example: 1
            pageSize:
              type: integer
              description: ページサイズ
              example: 10
            sort:
              type: object
              properties:
                empty:
                  type: boolean
                  description: 空かどうか
                  example: false
                sorted:
                  type: boolean
                  description: ソート済みかどうか
                  example: true
                unsorted:
                  type: boolean
                  description: 未ソートかどうか
                  example: false
              required:
                - empty
                - sorted
                - unsorted
            offset:
              type: integer
              description: オフセット
              example: 0
            unpaged:
              type: boolean
              description: ページング無効かどうか
              example: false
            paged:
              type: boolean
              description: ページング有効かどうか
              example: true
        last:
          type: boolean
          description: 最終ページかどうか
          example: true
        totalPages:
          type: integer
          description: 総ページ数
          example: 1
        totalElements:
          type: integer
          description: 総要素数
          example: 3
        first:
          type: boolean
          description: 最初のページかどうか
          example: true
        size:
          type: integer
          description: ページサイズ
          example: 10
        number:
          type: integer
          description: 現在のページ番号
          example: 1
        sort:
          type: object
          properties:
            empty:
              type: boolean
              description: 空かどうか
              example: false
            sorted:
              type: boolean
              description: ソート済みかどうか
              example: true
            unsorted:
              type: boolean
              description: 未ソートかどうか
              example: false
          required:
            - empty
            - sorted
            - unsorted
        numberOfElements:
          type: integer
          description: 現在のページの要素数
          example: 3
        empty:
          type: boolean
          description: 空かどうか
          example: false

    # PUTリクエストで渡されるパラメータ
    InsertDeviceFullDTO:
      type: object
      description: データ追加
      properties:
        name:
          type: string
          description: ユーザーの氏名
          example: 林飞
        deptId:
          type: string
          description: 部署番号
          example: DA04

        deviceId:
          type: string
          description: 機器番号
          example: HYRON-211217 PC-DC-058
        deviceModel:
          type: string
          description: ホストモデル
          example: dell-5090
        computerName:
          type: string
          description: コンピュータ名
          example: HYRON-JS-LINFEI
        LoginUserName:
          type: string
          description: ログインユーザ名
          example: linfei
        project:
          type: string
          description: 所属プロジェクト
          example: DA05支援
        devRoom:
          type: string
          description: 所属開発室
          example: M10
        userId:
          type: string
          description: 従業員番号（所属ユーザ、外部キー）
          example: JS0014
        remark:
          type: string
          description: 備考
          example: D1005開発室
        selfConfirmId:
          type: integer
          description: 本人確認ID
          example: 1
        osId:
          type: integer
          description: OSID
          example: 1
        memoryId:
          type: integer
          description: メモリID
          example: 1
        ssdId:
          type: integer
          description: SSDID
          example: 1
        hddId:
          type: integer
          description: HDDID
          example: 2
        ipAddress:
          type: string
          description: IPアドレス
          example: 192.168.203.139
        monitorName:
          type: string
          description: モニター名
          example: HYRON-151127 PC-DC-004JD
        creater:
          type: string
          description: 作成者
          example: admin

        # =======================Permission
    ApiResponseBase:
          type: object
          properties:
            code:
              type: integer
              description: ステータスコード
              example: 200
            message:
              type: string
              description: メッセージ
              example: "操作成功"
            data:
              type: object
              description: 応答データ
              nullable: true
              # example: null
          required:
            - code
            - message

    # # エラー応答
    # Error:
    #   allOf:
    #     - $ref: '#/components/schemas/ApiResponseBase'
    #     - type: object
    #       properties:
    #         timestamp:
    #           type: string
    #           format: date-time
    #           description:  エラー発生時刻

    # DTOスキーマ
    DevicePermissionDetailDTO:
      type: object
      properties:
        permissionId:
          type: string
          description: 権限番号
        deviceId:
          type: string
          description: 機器番号
        computerName:
          type: string
          description: コンピュータ名
        deviceModel:
          type: string
          description: ホストモデル
        project:
          type: string
          description: 所属プロジェクト
        devRoom:
          type: string
          description: 所属開発室
        userId:
          type: string
          description: ユーザID
        userName:
          type: string
          description: ユーザ名
        deptId:
          type: string
          description: 部署ID
        domainStatus:
          type: string
          description: ドメイン状態
        domainGroup:
          type: string
          description: ドメイン内グループ名
        noDomainReason:
          type: string
          description: ドメイン未参加理由
        smartitStatus:
          type: string
          description: SmartIT状態
        noSmartitReason:
          type: string
          description: SmartIT未インストール理由
        usbStatus:
          type: string
          description: USB状態
        usbReason:
          type: string
          description: USB使用許可理由
        usbExpireDate:
          type: string
          format: date
          description: USB使用有効期限
        antivirusStatus:
          type: string
          description: アンチウイルス状態
        noSymantecReason:
          type: string
          description: Symantec未導入理由
        remark:
          type: string
          description: 備考
        createTime:
          type: string
          format: date-time
          description: 作成日時
        creater:
          type: string
          description: 作成者
        updateTime:
          type: string
          format: date-time
          description: 更新日時
        updater:
          type: string
          description: 更新者

    #permissionIdはサービス内で生成されるuuidです
    DevicePermissionDTO:
          type: object
          properties:
            # permissionId:
            #   type: string
            #   example: ""
            deviceId:
              type: string
              example: "123123"
            domainStatus:
              type: string
              example: "39"
            domainGroup:
              type: string
              example: "hyronjs"
            noDomainReason:
              type: string
              example: "設備使用権限管理システムへの登録が必要です。"
            smartitStatus:
              type: string
              example: "41"
            noSmartitReason:
              type: string
              example: "SmartITへの登録が必要です。"
            usbStatus:
              type: string
              example: "44"
            usbReason:
              type: string
              example: "USB接続が必要です。"
            usbExpireDate:
              type: string
              example: "2022-12-31"
            antivirusStatus:
              type: string
              example: "47"
            noSymantecReason:
              type: string
              example: "Symantec Antivirusのインストールが必要です。"
            remark:
              type: string
              example: "備考"
            # createTime:
            #   type: string
            #   example: ""
            # creater:
            #   type: string
            #   example: ""
            # updateTime:
            #   type: string
            #   example: ""
            # updater:
            #   type: string
            #   example: ""
          required:
            - deviceId
            - domainStatus
            - smartitStatus
            - usbStatus
            - antivirusStatus

    DevicePermissionUpdateDTO:
          type: object
          properties:
            # permissionId:
            #   type: string
            #   example: ""
            domainStatus:
              type: string
              example: "39"
            domainGroup:
              type: string
              example: "hyronjs"
            noDomainReason:
              type: string
              example: "設備使用権限管理システムへの登録が必要です。"
            smartitStatus:
              type: string
              example: "41"
            noSmartitReason:
              type: string
              example: "SmartITへの登録が必要です。"
            usbStatus:
              type: string
              example: "44"
            usbReason:
              type: string
              example: "USB接続が必要です。"
            usbExpireDate:
              type: string
              example: "2022-12-31"
            antivirusStatus:
              type: string
              example: "47"
            noSymantecReason:
              type: string
              example: "Symantec Antivirusのインストールが必要です。"
            remark:
              type: string
              example: "備考"
          required:
            - domainStatus
            - smartitStatus
            - usbStatus
            - antivirusStatus
    # =======================Permission

    # POSTリクエストで渡されるパラメータ
    UpdateDeviceFullDTO:
      type: object
      description: データ追加
      properties:
        deviceModel:
          type: string
          description: ホストモデル
          example: dell-5090
        computerName:
          type: string
          description: コンピュータ名
          example: HYRON-JS-LINFEI
        LoginUserName:
          type: string
          description: ログインユーザ名
          example: linfei
        project:
          type: string
          description: 所属プロジェクト
          example: DA05支援
        devRoom:
          type: string
          description: 所属開発室
          example: M10
        userId:
          type: string
          description: 従業員番号（所属ユーザ、外部キー）
          example: JS0014
        remark:
          type: string
          description: 備考
          example: D1005開発室
        selfConfirmId:
          type: integer
          description: 本人確認ID
          example: 1
        osId:
          type: integer
          description: OSID
          example: 1
        memoryId:
          type: integer
          description: メモリID
          example: 1
        ssdId:
          type: integer
          description: SSDID
          example: 1
        hddId:
          type: integer
          description: HDDID
          example: 2

        ipId:
          type: integer
          description: IP番号
          example: 1
        ipAddress:
          type: string
          description: IPアドレス
          example: 192.168.203.139

        monitorId:
          type: integer
          description: モニター番号
          example: 1
        monitorName:
          type: string
          description: モニター名
          example: HYRON-151127 PC-DC-004JD

        updater:
          type: string
          description: 作成者
          example: admin


# =======================Permission
    ApiResponseBase:
      type: object
      properties:
        code:
          type: integer
          description: ステータスコード
          example: 200
        message:
          type: string
          description: メッセージ
          example: "操作成功"
        data:
            type: object
            description: 応答データ
            nullable: true
          # example: null
      required:
        - code
        - message

    # # エラー応答
    # Error:
    #   allOf:
    #     - $ref: '#/components/schemas/ApiResponseBase'
    #     - type: object
    #       properties:
    #         timestamp:
    #           type: string
    #           format: date-time
    #           description:  エラー発生時刻

    # DTOスキーマ
    DevicePermissionDetailDTO:
      type: object
      properties:
        permissionId:
          type: string
          description: 権限番号
        deviceId:
          type: string
          description: 機器番号
        computerName:
          type: string
          description: コンピュータ名
        deviceModel:
          type: string
          description: ホストモデル
        project:
          type: string
          description: 所属プロジェクト
        devRoom:
          type: string
          description: 所属開発室
        userId:
          type: string
          description: ユーザID
        userName:
          type: string
          description: ユーザ名
        deptId:
          type: string
          description: 部署ID
        domainStatus:
          type: string
          description: ドメイン状態
        domainGroup:
          type: string
          description: ドメイン内グループ名
        noDomainReason:
          type: string
          description: ドメイン未参加理由
        smartitStatus:
          type: string
          description: SmartIT状態
        noSmartitReason:
          type: string
          description: SmartIT未インストール理由
        usbStatus:
          type: string
          description: USB状態
        usbReason:
          type: string
          description: USB使用許可理由
        usbExpireDate:
          type: string
          format: date
          description: USB使用有効期限
        antivirusStatus:
          type: string
          description: アンチウイルス状態
        noSymantecReason:
          type: string
          description: Symantec未導入理由
        remark:
          type: string
          description: 備考
        createTime:
          type: string
          format: date-time
          description: 作成日時
        creater:
          type: string
          description: 作成者 
        updateTime:
          type: string
          format: date-time
          description: 更新日時
        updater:
          type: string
          description: 更新者 

    #permissionIdはサービス内で生成されるuuidです
    DevicePermissionDTO:
      type: object
      properties:
        # permissionId:
        #   type: string
        #   example: ""
        deviceId:
          type: string
          example: "123123"
        domainStatus:
          type: string
          example: "39"
        domainGroup:
          type: string
          example: "hyronjs"
        noDomainReason:
          type: string
          example: "設備使用権限管理システムへの登録が必要です。"
        smartitStatus:
          type: string
          example: "41"
        noSmartitReason:
          type: string
          example: "SmartITへの登録が必要です。"
        usbStatus:
          type: string
          example: "44"
        usbReason:
          type: string
          example: "USB接続が必要です。"
        usbExpireDate:
          type: string
          example: "2022-12-31"
        antivirusStatus:
          type: string
          example: "47"
        noSymantecReason:
          type: string
          example: "Symantec Antivirusのインストールが必要です。"
        remark:
          type: string
          example: "備考"
        # createTime:
        #   type: string
        #   example: ""
        # creater:
        #   type: string
        #   example: ""
        # updateTime:
        #   type: string
        #   example: ""
        # updater:
        #   type: string
        #   example: ""
      required:
        - deviceId
        - domainStatus
        - smartitStatus
        - usbStatus
        - antivirusStatus

    DevicePermissionUpdateDTO:
        type: object
        properties:
          # permissionId:
          #   type: string
          #   example: ""
          domainStatus:
            type: string
            example: "39"
          domainGroup:
            type: string
            example: "hyronjs"
          noDomainReason:
            type: string
            example: "設備使用権限管理システムへの登録が必要です。"
          smartitStatus:
            type: string
            example: "41"
          noSmartitReason:
            type: string
            example: "SmartITへの登録が必要です。"
          usbStatus:
            type: string
            example: "44"
          usbReason:
            type: string
            example: "USB接続が必要です。"
          usbExpireDate:
            type: string
            example: "2022-12-31"
          antivirusStatus:
            type: string
            example: "47"
          noSymantecReason:
            type: string
            example: "Symantec Antivirusのインストールが必要です。"
          remark:
            type: string
            example: "備考"
        required:
          - domainStatus
          - smartitStatus
          - usbStatus
          - antivirusStatus
# =======================Permission
  responses:
    Success:
      description: 操作成功
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ApiResponse'
          examples:
            default:
              value:
                code: 200
                message: "成功"

            deleteSuccess:
              value:
                code: 200
                message: "削除成功"

            createSuccess:
              value:
                code: 200
                message: "作成成功"

    SuccessWithDetail:
      description: 設備詳細情報の取得に成功
      content:
        application/json:
          schema:
            type: object
            properties:
              code:
                type: integer
                example: 200
              message:
                type: string
                example: "設備詳細情報の取得に成功"
              data:
                type: object
                properties:
                  deviceInfo:
                    $ref: '#/components/schemas/Device'


    SuccessWithPagination:
      description: 設備リストの取得に成功
      content:
        application/json:
          schema:
            type: object
            properties:
              code:
                type: integer
                example: 200
              message:
                type: string
                example: "設備リストの取得に成功"
              data:
                $ref: '#/components/schemas/DevicePageResponse'



    InsertSuccess:
      description: 挿入成功
      content:
        application/json:
          schema:
            allOf:
              - $ref: '#/components/schemas/ApiResponse'
              - type: object
                properties:
                  code:
                    type: integer
                    description: 挿入成功
                    example: 200
                  message:
                    type: string
                    description: 挿入成功
                    example: "挿入成功"
                  data:
                    $ref: '#/components/schemas/InsertDeviceFullDTO'

    UpdateSuccess:
      description: 更新成功
      content:
        application/json:
          schema:
            allOf:
              - $ref: '#/components/schemas/ApiResponse'
              - type: object
                properties:
                  code:
                    type: integer
                    description: 更新成功
                    example: 200
                  message:
                    type: string
                    description: 更新成功
                    example: "更新成功"
                  data:
                    $ref: '#/components/schemas/UpdateDeviceFullDTO'


    BadRequest:
      description: リクエストパラメータエラー
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          examples:
            default:
              value:
                code: 400
                message: "パラメータ検証エラー"
                error:
                  - field: "deviceId"
                    message: "設備IDは必須です"
                    code: "INVALID_PARAMETER"
                    data: null
                    total: null
                    page: null
                    size: null
            pageParamError:
              value:
                code: 400
                message: "ページングパラメータエラー"
                error:
                  - field: "page"
                    message: "ページ番号は正の整数である必要があります"
                    code: "INVALID_PAGE_NUMBER"
                    data: null
                    total: null
                    page: null
                    size: null
    
    Unauthorized:
      description: JWT が無効または期限切れです
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            code: 40100
            message: "トークンが無効または期限切れです"
            data: null
            total: null
            page: null
            size: null


    
    NotFound:
      description: リソースが見つかりません
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ApiResponse'
          examples:
            default:
              value:
                code: 404
                message: "リソースが見つかりません"
                data: null
                total: null
                page: null
                size: null
            deviceNotFound:
              value:
                code: 404
                message: "設備が存在しません"
                data: null
                total: null
                page: null
                size: null
            userNotFound:
              value:
                code: 404
                message: "ユーザーが存在しません"
                data: null
                total: null
                page: null
                size: null

    InternalError:
      description: サーバー内部エラー
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            code: 50000
            message: "サーバーが混雑しています。しばらくしてから再度お試しください"
            data: null
            total: null
            page: null
            size: null
    InternalServerError:
      description: サーバー内部エラー
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ApiResponse'
          examples:
            default:
              value:
                code: 500
                message: "サーバー内部エラー、後ほど再試行してください"
                data: null
                total: null
                page: null
                size: null
            databaseError:
              value:
                code: 500
                message: "データベース接続エラー"
                data: null
                total: null
                page: null
                size: null
